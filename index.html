<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Doncaster Coffee Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
  <style>
    body { margin: 0; padding: 0; font-family: sans-serif; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }
    .search-box {
      position: absolute;
      z-index: 1;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      border-radius: 5px;
      padding: 6px 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    input[type="text"] {
      padding: 6px;
      width: 200px;
      border: 1px solid #ccc;
      border-radius: 3px;
    }
    .popup-button {
      margin-top: 5px;
      display: inline-block;
      background: #0078A8;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <div class="search-box">
    <input type="text" id="search" placeholder="Search for a place...">
  </div>
  <div id="map"></div>
  <script>
    mapboxgl.accessToken = 'pk.eyJ1Ijoic2lnaHRzZWVrciIsImEiOiJjbWJheDU5dWwwbjZqMmxzYjRqaW0wZ2FoIn0.XjR_Z_6vL3dcXrVECelgiA';
    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/sightseekr/cmdlr4rap009h01r23f5z6h7i',
      center: [-1.13, 53.52],
      zoom: 10.4
    });

    const geojsonData = {
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.118326662242924, 53.52227855274466]
      },
      "properties": {
        "name": "West Street Coffee",
        "description": "Great for coffee and cake.",
        "link": "https://www.google.com/maps?cid=7732098197170659430"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.1292517200610472, 53.52388521860511]
      },
      "properties": {
        "name": "Cafe 1910 (In Danum Gallery, Library and Museum)",
        "description": "A relaxed space inside the museum.",
        "link": "https://www.google.com/maps?cid=1008549081973229459"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.1390276619561702, 53.52259802251943]
      },
      "properties": {
        "name": "Bone Idle Lounge",
        "description": "Cosy independent coffee lounge.",
        "link": "https://google.com/maps?cid=11035181184400722709"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.131123504036539, 53.52257959936845]
      },
      "properties": {
        "name": "Da Leo Restaurant",
        "description": "Italian restaurant with excellent coffee.",
        "link": "https://www.google.com/maps?cid=6913375424484086838"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.1320559692639953, 53.52271781229183]
      },
      "properties": {
        "name": "Doncaster Tourist Information Centre",
        "description": "Find info and a good espresso.",
        "link": "https://www.google.com/maps?cid=674239188930906122"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.1320216791303337, 53.52230456701365]
      },
      "properties": {
        "name": "The Glass Strawberry",
        "description": "Vibrant cafe with fresh breakfast and coffee.",
        "link": "https://www.google.com/maps?cid=17678315068369981247"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.1321804567236492, 53.52285945779891]
      },
      "properties": {
        "name": "Banco Coffee Co",
        "description": "Trendy and modern cafe.",
        "link": "https://www.google.com/maps?cid=1769371057472287012"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.1342237625787765, 53.52344008120708]
      },
      "properties": {
        "name": "Jazz Cafe",
        "description": "Live music and strong coffee.",
        "link": "https://www.google.com/maps?cid=14635295943506975263"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.132827, 53.522761]
      },
      "properties": {
        "name": "Old man Staveley's coffee co",
        "description": "Quirky vintage cafe with espresso blends.",
        "link": "https://www.google.com/maps?cid=11699623048919577819"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.132552, 53.522458]
      },
      "properties": {
        "name": "Back in Time CafÃ©",
        "description": "Retro themed cafe.",
        "link": "http://google.com/maps?cid=10559689921745810730"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.148336, 53.544083]
      },
      "properties": {
        "name": "Boston & Co Bentley Pavilion",
        "description": "Community coffee hub.",
        "link": "https://www.google.com/maps?cid=9765442256895214233"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.133673, 53.522978]
      },
      "properties": {
        "name": "Jimmy Piggs Coffee House",
        "description": "Large menu and popular brunch spot.",
        "link": "https://www.google.com/maps?cid=9568668619399891490"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.120967, 53.523114]
      },
      "properties": {
        "name": "Cornerstone Coffee",
        "description": "Friendly staff and artisan coffee.",
        "link": "https://www.google.com/maps?cid=272364922763009188"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.128888, 53.522201]
      },
      "properties": {
        "name": "Highfield Coffee Social",
        "description": "Warm community space and cafe.",
        "link": "https://www.google.com/maps?cid=14653791595216298550"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.130578, 53.500283]
      },
      "properties": {
        "name": "TWEED at Wadworth",
        "description": "Hidden gem just outside the centre.",
        "link": "https://www.google.com/maps?cid=9866149075741907923"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-1.105001, 53.429981]
      },
      "properties": {
        "name": "Feast Bawtry",
        "description": "Stylish cafe in Bawtry.",
        "link": "https://www.google.com/maps?cid=14094552448568676862"
      }
    }
  ]
};

    map.on('load', () => {
      map.addSource('points', {
        type: 'geojson',
        data: geojsonData
      });

      map.addLayer({
        id: 'points-layer',
        type: 'circle',
        source: 'points',
        paint: {
          'circle-radius': 6,
          'circle-color': '#FF5722'
        }
      });

      let popup = new mapboxgl.Popup({ closeOnClick: true });

      map.on('click', 'points-layer', (e) => {
        const props = e.features[0].properties;
        const coords = e.features[0].geometry.coordinates;
        const html = `
          <strong>${props.name}</strong><br>
          ${props.description}<br>
          <a class="popup-button" href="${props.link}" target="_blank">Directions</a>
        `;
        popup.setLngLat(coords).setHTML(html).addTo(map);
      });

      map.on('mouseenter', 'points-layer', () => {
        map.getCanvas().style.cursor = 'pointer';
      });

      map.on('mouseleave', 'points-layer', () => {
        map.getCanvas().style.cursor = '';
      });

      document.getElementById('search').addEventListener('input', function () {
        const value = this.value.toLowerCase();
        const match = geojsonData.features.find(f => f.properties.name.toLowerCase().includes(value));
        if (match) {
          const coords = match.geometry.coordinates;
          map.flyTo({ center: coords, zoom: 14 });
          const html = `
            <strong>${match.properties.name}</strong><br>
            ${match.properties.description}<br>
            <a class="popup-button" href="${match.properties.link}" target="_blank">Directions</a>
          `;
          popup.setLngLat(coords).setHTML(html).addTo(map);
        }
      });
    });
  </script>
</body>
</html>
